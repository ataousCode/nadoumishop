openapi: 3.0.0
info:
  title: Nadoumi Shop API
  description: API Documentation for Nadoumi Shop
  version: 1.0.0
servers:
  - url: http://localhost:5001/api/v1
    description: Local server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    VerifyOtp:
      type: object
      required: [email, otp]
      properties:
        email:
          type: string
        otp:
          type: string
    ForgotPassword:
      type: object
      required: [email]
      properties:
        email:
          type: string
    ResetPassword:
      type: object
      required: [token, newPassword, confirmPassword]
      properties:
        token:
          type: string
        newPassword:
          type: string
        confirmPassword:
          type: string
    RefreshToken:
      type: object
      required: [refreshToken]
      properties:
        refreshToken:
          type: string
    User:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
        name:
          type: string
        role:
          type: string
          enum: [USER, ADMIN]
    Error:
      type: object
      properties:
        status:
          type: string
        message:
          type: string

security:
  - bearerAuth: []

paths:
  /:
    get:
      summary: Health check
      responses:
        "200":
          description: Successful response
  /auth/signup:
    post:
      summary: Register a new user
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, name]
              properties:
                email:
                  type: string
                password:
                  type: string
                name:
                  type: string
      responses:
        "201":
          description: User created
  /auth/login:
    post:
      summary: Login user
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        "200":
          description: Login successful
  /auth/refresh-token:
    post:
      summary: Refresh access token
      tags: [Auth]
      responses:
        "200":
          description: Token refreshed
  /auth/logout:
    post:
      summary: Logout user
      tags: [Auth]
      responses:
        "200":
          description: Logged out
  /auth/verify-otp:
    post:
      summary: Verify OTP
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyOtp"
      responses:
        "200":
          description: OTP verified successfully
  /auth/forgot-password:
    post:
      summary: Request password reset
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPassword"
      responses:
        "200":
          description: Password reset email sent
  /auth/reset-password:
    post:
      summary: Reset password
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPassword"
      responses:
        "200":
          description: Password reset successfully
  /users/me:
    get:
      summary: Get current user profile
      tags: [Users]
      security:
        - bearerAuth: []
      responses:
        "200":
          description: User profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
    patch:
      summary: Update current user profile
      tags: [Users]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                email:
                  type: string
      responses:
        "200":
          description: Profile updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
